{"ast":null,"code":"import { splitStringToChunks } from '../util.js';\nimport { getNumberOfChar } from './string-format.js';\nexport function minimalStringToSimpleBdd(str) {\n  const nodesById = new Map();\n  // parse leaf nodes\n  const leafNodeAmount = parseInt(str.charAt(0) + str.charAt(1), 10);\n  const lastLeafNodeChar = 2 + leafNodeAmount * 2;\n  const leafNodeChars = str.substring(2, lastLeafNodeChar);\n  const leafNodeChunks = splitStringToChunks(leafNodeChars, 2);\n  for (let i = 0; i < leafNodeChunks.length; i++) {\n    const chunk = leafNodeChunks[i];\n    const id = chunk.charAt(0);\n    const value = getNumberOfChar(chunk.charAt(1));\n    nodesById.set(id, value);\n  }\n  // parse internal nodes\n  const internalNodeChars = str.substring(lastLeafNodeChar, str.length - 3);\n  const internalNodeChunks = splitStringToChunks(internalNodeChars, 4);\n  for (let i = 0; i < internalNodeChunks.length; i++) {\n    const chunk = internalNodeChunks[i];\n    const id = chunk.charAt(0);\n    const idOf0Branch = chunk.charAt(1);\n    const idOf1Branch = chunk.charAt(2);\n    const level = getNumberOfChar(chunk.charAt(3));\n    if (!nodesById.has(idOf0Branch)) {\n      throw new Error('missing node with id ' + idOf0Branch);\n    }\n    if (!nodesById.has(idOf1Branch)) {\n      throw new Error('missing node with id ' + idOf1Branch);\n    }\n    const node0 = nodesById.get(idOf0Branch);\n    const node1 = nodesById.get(idOf1Branch);\n    const node = {\n      l: level,\n      // level is first for prettier json output\n      0: node0,\n      1: node1\n    };\n    nodesById.set(id, node);\n  }\n  // parse root node\n  const last3 = str.slice(-3);\n  const idOf0 = last3.charAt(0);\n  const idOf1 = last3.charAt(1);\n  const levelOfRoot = getNumberOfChar(last3.charAt(2));\n  const nodeOf0 = nodesById.get(idOf0);\n  const nodeOf1 = nodesById.get(idOf1);\n  const rootNode = {\n    l: levelOfRoot,\n    0: nodeOf0,\n    1: nodeOf1\n  };\n  return rootNode;\n}","map":{"version":3,"names":["splitStringToChunks","getNumberOfChar","minimalStringToSimpleBdd","str","nodesById","Map","leafNodeAmount","parseInt","charAt","lastLeafNodeChar","leafNodeChars","substring","leafNodeChunks","i","length","chunk","id","value","set","internalNodeChars","internalNodeChunks","idOf0Branch","idOf1Branch","level","has","Error","node0","get","node1","node","l","last3","slice","idOf0","idOf1","levelOfRoot","nodeOf0","nodeOf1","rootNode"],"sources":["/Users/abdelghanem/Desktop/tasker/node_modules/binary-decision-diagram/src/minimal-string/minimal-string-to-simple-bdd.ts"],"sourcesContent":["import {\n    SimpleBdd,\n    SimpleBddLeafNode\n} from '../types.js';\nimport { splitStringToChunks } from '../util.js';\nimport { getNumberOfChar } from './string-format.js';\n\nexport function minimalStringToSimpleBdd(\n    str: string\n): SimpleBdd {\n    const nodesById: Map<string, SimpleBdd | SimpleBddLeafNode> = new Map();\n\n    // parse leaf nodes\n    const leafNodeAmount = parseInt(str.charAt(0) + str.charAt(1), 10);\n    const lastLeafNodeChar = (2 + leafNodeAmount * 2);\n    const leafNodeChars = str.substring(2, lastLeafNodeChar);\n    const leafNodeChunks = splitStringToChunks(leafNodeChars, 2);\n    for (let i = 0; i < leafNodeChunks.length; i++) {\n        const chunk = leafNodeChunks[i];\n        const id = chunk.charAt(0);\n        const value: SimpleBddLeafNode = getNumberOfChar(chunk.charAt(1));\n        nodesById.set(id, value);\n    }\n\n    // parse internal nodes\n    const internalNodeChars = str.substring(lastLeafNodeChar, str.length - 3);\n    const internalNodeChunks = splitStringToChunks(internalNodeChars, 4);\n    for (let i = 0; i < internalNodeChunks.length; i++) {\n        const chunk = internalNodeChunks[i];\n        const id = chunk.charAt(0);\n        const idOf0Branch = chunk.charAt(1);\n        const idOf1Branch = chunk.charAt(2);\n        const level = getNumberOfChar(chunk.charAt(3));\n\n\n        if (!nodesById.has(idOf0Branch)) {\n            throw new Error('missing node with id ' + idOf0Branch);\n        }\n        if (!nodesById.has(idOf1Branch)) {\n            throw new Error('missing node with id ' + idOf1Branch);\n        }\n\n        const node0 = nodesById.get(idOf0Branch) as SimpleBdd;\n        const node1 = nodesById.get(idOf1Branch) as SimpleBdd;\n        const node: SimpleBdd = {\n            l: level, // level is first for prettier json output\n            0: node0,\n            1: node1\n        };\n        nodesById.set(id, node);\n    }\n\n    // parse root node\n    const last3 = str.slice(-3);\n    const idOf0 = last3.charAt(0);\n    const idOf1 = last3.charAt(1);\n    const levelOfRoot = getNumberOfChar(last3.charAt(2));\n    const nodeOf0 = nodesById.get(idOf0) as SimpleBdd;\n    const nodeOf1 = nodesById.get(idOf1) as SimpleBdd;\n    const rootNode: SimpleBdd = {\n        l: levelOfRoot,\n        0: nodeOf0,\n        1: nodeOf1,\n    };\n\n    return rootNode;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}