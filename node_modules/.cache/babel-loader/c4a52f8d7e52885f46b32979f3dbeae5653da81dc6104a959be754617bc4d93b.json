{"ast":null,"code":"import { microSeconds as micro } from '../util.js';\nexport var microSeconds = micro;\nexport var type = 'simulate';\nvar SIMULATE_CHANNELS = new Set();\nexport function create(channelName) {\n  var state = {\n    time: microSeconds(),\n    name: channelName,\n    messagesCallback: null\n  };\n  SIMULATE_CHANNELS.add(state);\n  return state;\n}\nexport function close(channelState) {\n  SIMULATE_CHANNELS[\"delete\"](channelState);\n}\nexport var SIMULATE_DELAY_TIME = 5;\nexport function postMessage(channelState, messageJson) {\n  return new Promise(function (res) {\n    return setTimeout(function () {\n      var channelArray = Array.from(SIMULATE_CHANNELS);\n      channelArray.forEach(function (channel) {\n        if (channel.name === channelState.name &&\n        // has same name\n        channel !== channelState &&\n        // not own channel\n        !!channel.messagesCallback &&\n        // has subscribers\n        channel.time < messageJson.time // channel not created after postMessage() call\n        ) {\n          channel.messagesCallback(messageJson);\n        }\n      });\n      res();\n    }, SIMULATE_DELAY_TIME);\n  });\n}\nexport function onMessage(channelState, fn) {\n  channelState.messagesCallback = fn;\n}\nexport function canBeUsed() {\n  return true;\n}\nexport function averageResponseTime() {\n  return SIMULATE_DELAY_TIME;\n}\nexport var SimulateMethod = {\n  create: create,\n  close: close,\n  onMessage: onMessage,\n  postMessage: postMessage,\n  canBeUsed: canBeUsed,\n  type: type,\n  averageResponseTime: averageResponseTime,\n  microSeconds: microSeconds\n};","map":{"version":3,"names":["microSeconds","micro","type","SIMULATE_CHANNELS","Set","create","channelName","state","time","name","messagesCallback","add","close","channelState","SIMULATE_DELAY_TIME","postMessage","messageJson","Promise","res","setTimeout","channelArray","Array","from","forEach","channel","onMessage","fn","canBeUsed","averageResponseTime","SimulateMethod"],"sources":["/Users/abdelghanem/Desktop/tasker/node_modules/broadcast-channel/dist/esbrowser/methods/simulate.js"],"sourcesContent":["import { microSeconds as micro } from '../util.js';\nexport var microSeconds = micro;\nexport var type = 'simulate';\nvar SIMULATE_CHANNELS = new Set();\nexport function create(channelName) {\n  var state = {\n    time: microSeconds(),\n    name: channelName,\n    messagesCallback: null\n  };\n  SIMULATE_CHANNELS.add(state);\n  return state;\n}\nexport function close(channelState) {\n  SIMULATE_CHANNELS[\"delete\"](channelState);\n}\nexport var SIMULATE_DELAY_TIME = 5;\nexport function postMessage(channelState, messageJson) {\n  return new Promise(function (res) {\n    return setTimeout(function () {\n      var channelArray = Array.from(SIMULATE_CHANNELS);\n      channelArray.forEach(function (channel) {\n        if (channel.name === channelState.name &&\n        // has same name\n        channel !== channelState &&\n        // not own channel\n        !!channel.messagesCallback &&\n        // has subscribers\n        channel.time < messageJson.time // channel not created after postMessage() call\n        ) {\n          channel.messagesCallback(messageJson);\n        }\n      });\n      res();\n    }, SIMULATE_DELAY_TIME);\n  });\n}\nexport function onMessage(channelState, fn) {\n  channelState.messagesCallback = fn;\n}\nexport function canBeUsed() {\n  return true;\n}\nexport function averageResponseTime() {\n  return SIMULATE_DELAY_TIME;\n}\nexport var SimulateMethod = {\n  create: create,\n  close: close,\n  onMessage: onMessage,\n  postMessage: postMessage,\n  canBeUsed: canBeUsed,\n  type: type,\n  averageResponseTime: averageResponseTime,\n  microSeconds: microSeconds\n};"],"mappings":"AAAA,SAASA,YAAY,IAAIC,KAAK,QAAQ,YAAY;AAClD,OAAO,IAAID,YAAY,GAAGC,KAAK;AAC/B,OAAO,IAAIC,IAAI,GAAG,UAAU;AAC5B,IAAIC,iBAAiB,GAAG,IAAIC,GAAG,CAAC,CAAC;AACjC,OAAO,SAASC,MAAMA,CAACC,WAAW,EAAE;EAClC,IAAIC,KAAK,GAAG;IACVC,IAAI,EAAER,YAAY,CAAC,CAAC;IACpBS,IAAI,EAAEH,WAAW;IACjBI,gBAAgB,EAAE;EACpB,CAAC;EACDP,iBAAiB,CAACQ,GAAG,CAACJ,KAAK,CAAC;EAC5B,OAAOA,KAAK;AACd;AACA,OAAO,SAASK,KAAKA,CAACC,YAAY,EAAE;EAClCV,iBAAiB,CAAC,QAAQ,CAAC,CAACU,YAAY,CAAC;AAC3C;AACA,OAAO,IAAIC,mBAAmB,GAAG,CAAC;AAClC,OAAO,SAASC,WAAWA,CAACF,YAAY,EAAEG,WAAW,EAAE;EACrD,OAAO,IAAIC,OAAO,CAAC,UAAUC,GAAG,EAAE;IAChC,OAAOC,UAAU,CAAC,YAAY;MAC5B,IAAIC,YAAY,GAAGC,KAAK,CAACC,IAAI,CAACnB,iBAAiB,CAAC;MAChDiB,YAAY,CAACG,OAAO,CAAC,UAAUC,OAAO,EAAE;QACtC,IAAIA,OAAO,CAACf,IAAI,KAAKI,YAAY,CAACJ,IAAI;QACtC;QACAe,OAAO,KAAKX,YAAY;QACxB;QACA,CAAC,CAACW,OAAO,CAACd,gBAAgB;QAC1B;QACAc,OAAO,CAAChB,IAAI,GAAGQ,WAAW,CAACR,IAAI,CAAC;QAAA,EAC9B;UACAgB,OAAO,CAACd,gBAAgB,CAACM,WAAW,CAAC;QACvC;MACF,CAAC,CAAC;MACFE,GAAG,CAAC,CAAC;IACP,CAAC,EAAEJ,mBAAmB,CAAC;EACzB,CAAC,CAAC;AACJ;AACA,OAAO,SAASW,SAASA,CAACZ,YAAY,EAAEa,EAAE,EAAE;EAC1Cb,YAAY,CAACH,gBAAgB,GAAGgB,EAAE;AACpC;AACA,OAAO,SAASC,SAASA,CAAA,EAAG;EAC1B,OAAO,IAAI;AACb;AACA,OAAO,SAASC,mBAAmBA,CAAA,EAAG;EACpC,OAAOd,mBAAmB;AAC5B;AACA,OAAO,IAAIe,cAAc,GAAG;EAC1BxB,MAAM,EAAEA,MAAM;EACdO,KAAK,EAAEA,KAAK;EACZa,SAAS,EAAEA,SAAS;EACpBV,WAAW,EAAEA,WAAW;EACxBY,SAAS,EAAEA,SAAS;EACpBzB,IAAI,EAAEA,IAAI;EACV0B,mBAAmB,EAAEA,mBAAmB;EACxC5B,YAAY,EAAEA;AAChB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}