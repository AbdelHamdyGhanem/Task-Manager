{"ast":null,"code":"// https://www.mongodb.com/docs/manual/reference/operator/aggregation/bottomN/#mongodb-group-grp.-bottomN\nimport { Aggregator } from \"../../aggregator\";\nimport { ComputeOptions, computeValue } from \"../../core\";\nimport { $push } from \"./push\";\n/**\n * Returns an aggregation of the bottom n elements within a group, according to the specified sort order.\n * If the group contains fewer than n elements, $bottomN returns all elements in the group.\n *\n * @param {Array} collection The input array\n * @param {Object} expr The right-hand side expression value of the operator\n * @param {Options} options The options to use for this operation\n * @returns {*}\n */\nexport const $bottomN = (collection, expr, options) => {\n  const copts = ComputeOptions.init(options);\n  const {\n    n,\n    sortBy\n  } = computeValue(copts.local.groupId, expr, null, copts);\n  const result = new Aggregator([{\n    $sort: sortBy\n  }], copts).run(collection);\n  const m = result.length;\n  const p = n;\n  return $push(m <= p ? result : result.slice(m - p), expr.output, copts);\n};","map":{"version":3,"names":["Aggregator","ComputeOptions","computeValue","$push","$bottomN","collection","expr","options","copts","init","n","sortBy","local","groupId","result","$sort","run","m","length","p","slice","output"],"sources":["/Users/abdelghanem/Desktop/tasker/node_modules/mingo/dist/esm/operators/accumulator/bottomN.js"],"sourcesContent":["// https://www.mongodb.com/docs/manual/reference/operator/aggregation/bottomN/#mongodb-group-grp.-bottomN\nimport { Aggregator } from \"../../aggregator\";\nimport { ComputeOptions, computeValue } from \"../../core\";\nimport { $push } from \"./push\";\n/**\n * Returns an aggregation of the bottom n elements within a group, according to the specified sort order.\n * If the group contains fewer than n elements, $bottomN returns all elements in the group.\n *\n * @param {Array} collection The input array\n * @param {Object} expr The right-hand side expression value of the operator\n * @param {Options} options The options to use for this operation\n * @returns {*}\n */\nexport const $bottomN = (collection, expr, options) => {\n    const copts = ComputeOptions.init(options);\n    const { n, sortBy } = computeValue(copts.local.groupId, expr, null, copts);\n    const result = new Aggregator([{ $sort: sortBy }], copts).run(collection);\n    const m = result.length;\n    const p = n;\n    return $push(m <= p ? result : result.slice(m - p), expr.output, copts);\n};\n"],"mappings":"AAAA;AACA,SAASA,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,cAAc,EAAEC,YAAY,QAAQ,YAAY;AACzD,SAASC,KAAK,QAAQ,QAAQ;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,QAAQ,GAAGA,CAACC,UAAU,EAAEC,IAAI,EAAEC,OAAO,KAAK;EACnD,MAAMC,KAAK,GAAGP,cAAc,CAACQ,IAAI,CAACF,OAAO,CAAC;EAC1C,MAAM;IAAEG,CAAC;IAAEC;EAAO,CAAC,GAAGT,YAAY,CAACM,KAAK,CAACI,KAAK,CAACC,OAAO,EAAEP,IAAI,EAAE,IAAI,EAAEE,KAAK,CAAC;EAC1E,MAAMM,MAAM,GAAG,IAAId,UAAU,CAAC,CAAC;IAAEe,KAAK,EAAEJ;EAAO,CAAC,CAAC,EAAEH,KAAK,CAAC,CAACQ,GAAG,CAACX,UAAU,CAAC;EACzE,MAAMY,CAAC,GAAGH,MAAM,CAACI,MAAM;EACvB,MAAMC,CAAC,GAAGT,CAAC;EACX,OAAOP,KAAK,CAACc,CAAC,IAAIE,CAAC,GAAGL,MAAM,GAAGA,MAAM,CAACM,KAAK,CAACH,CAAC,GAAGE,CAAC,CAAC,EAAEb,IAAI,CAACe,MAAM,EAAEb,KAAK,CAAC;AAC3E,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}